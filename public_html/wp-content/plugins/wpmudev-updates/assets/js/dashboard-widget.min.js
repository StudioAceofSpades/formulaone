!function(){"use strict";var a;(a=jQuery)((function(){function t(t){var i=[];void 0!==wdp_analytics_ajax.current_data&&void 0!==wdp_analytics_ajax.current_data.totals&&(i=wdp_analytics_ajax.current_data.totals),a(".wpmudui-chart-options button").hide(),a.each(i,(function(t,i){var e=a('.wpmudui-chart-options button[data-type="'+t+'"]');e.length&&(e.find(".wpmudui-chart-option-value").html(i.value),e.find(".wpmudui-chart-option-trend").html(i.change),e.removeClass("wpmudui-up wpmudui-down wpmudui-none").addClass("wpmudui-"+i.direction),e.show())})),t?("unique_pageviews"===t&&(t="pageviews"),a('.wpmudui-chart-options button[data-type="'+t+'"]').click()):a(".wpmudui-chart-options button").filter((function(){return"none"!=a(this).css("display")})).filter(":first").click()}var i,e,n,d,o,u,r;0!==a(".wpmudui-analytics").length&&(o=a(".wpmudui-tabs"),u=o.find("> [data-tabs]"),r=o.find("> [data-tabs] > [data-tab]"),0!==u.length&&(r.on("click",(function(t){var i=a(this),e=a(this).closest(".wpmudui-tabs"),n=e.find("> [data-panes]"),d=e.find("> [data-panes] > [data-pane]"),o=a(this).data("tab"),u=e.find('> [data-panes] > [data-pane="'+o+'"]');i.parent().find("> [data-tab]").removeClass("wpmudui-current"),i.addClass("wpmudui-current"),0!==n.length&&(d.hide(),u.show()),t.stopPropagation()})),a(".wpmudui-analytics-tabs .wpmudui-current").click()),a(".wpmudui-analytics-range").on("change",(function(t){window.location.assign(document.location.origin+document.location.pathname+"?tab="+a(".wpmudui-analytics-tabs .wpmudui-current").data("tab")+"&analytics_range="+a(this).val())})),a(".wpmudui-analytics-column-filter").on("change",(function(t){var i=a(this).parents(".wpmudui-tab-content"),e=a(i).find(".wpmudui-table");a(i).find(".wpmudui-table-views").removeClass("wpmudui-current"),a(i).find(".wpmudui-table-views.data-"+this.value).addClass("wpmudui-current");var n=a(i).find(".wpmudui-table-item"),d=".data-"+a(this).val();n.sort((function(t,i){return+a(i).find(d).data("sort")-+a(t).find(d).data("sort")})),a(i).find(".wpmudui-table-sortable").append(n),e.trigger("reset"),t.stopPropagation()})),a(".wpmudui-analytics-column-filter").change(),a(".wpmudui-table-item").on("click",(function(i){var e={action:"wdp-analytics"};e.hash=wdp_analytics_ajax.nonce,e.type=a(this).data("filter-type"),e.filter=a(this).data("filter"),e.range=a("#wpmudui-analytics-range").val();var n=a(this).parents(".wpmudui-tab-content"),d=a(this).find("td:first-child"),o=a(this).data("label")+" "+d.text();d.find(".wpmudui-icon").remove(),d.prepend('<span class="wpmudui-icon wpmudui-icon-loader wpmudui-loading"></span>'),a.post(window.ajaxurl,e,(function(i){i.success?(wdp_analytics_ajax.current_data=i.data,t(a(n).find(".wpmudui-analytics-column-filter").val()),a("#wpmudui-analytics-search").val(o),a('.wpmudui-analytics-tabs a[data-tab="overview"]').click(),d.find(".wpmudui-icon").remove()):(d.find(".wpmudui-icon").remove(),d.prepend('<span class="wpmudui-icon dashicons dashicons-warning"></span>').find(".wpmudui-icon").fadeOut(2e3))}),"json").always((function(){})).fail((function(a){d.find(".wpmudui-icon").remove(),d.prepend('<span class="wpmudui-icon dashicons dashicons-warning"></span>').find(".wpmudui-icon").fadeOut(2e3)})),i.stopPropagation()})),d=moment.locale(),moment.updateLocale(wdp_analytics_ajax.locale_settings.locale,{parentLocale:d,monthsShort:wdp_analytics_ajax.locale_settings.monthsShort,weekdays:wdp_analytics_ajax.locale_settings.weekdays}),moment.locale(wdp_analytics_ajax.locale_settings.locale),(n=a(".wpmudui-chart-options").find("button")).on("click",(function(t){n.removeClass("wpmudui-current"),a(this).addClass("wpmudui-current"),function(t){var i=a("#wpmudui-analytics-graph"),e=wdp_analytics_ajax.current_data.chart;function n(a){var t=Math.floor(a/60)%60,i="";return t&&(i=i+t+"m"),(a-=60*t)&&(i.length&&(i+=" "),i=i+a+"s"),i}Chart.defaults.LineWithLine=Chart.defaults.line,Chart.controllers.LineWithLine=Chart.controllers.line.extend({draw:function(a){if(Chart.controllers.line.prototype.draw.call(this,a),this.chart.tooltip._active&&this.chart.tooltip._active.length){var t=this.chart.tooltip._active[0],i=this.chart.ctx,e=t.tooltipPosition().x,n=this.chart.scales["y-axis-0"].top,d=this.chart.scales["y-axis-0"].bottom;i.save(),i.beginPath(),i.moveTo(e,n),i.lineTo(e,d),i.lineWidth=1,i.strokeStyle="rgba(0, 0, 0, 0.1)",i.stroke(),i.restore()}}});var d={type:"LineWithLine",data:{datasets:[{label:"NA",backgroundColor:"rgba(0,133,186,0.98)",borderColor:"rgba(0,133,186,0.98)",borderWidth:3,pointRadius:3,pointBorderWidth:1,pointBorderColor:"white",pointBackgroundColor:"rgba(0,133,186,0.98)",fill:!1,data:[]}]},options:{legend:{display:!0},tooltips:{mode:"x",intersect:!1,displayColors:!1,titleFontSize:12,callbacks:{label:function(a,t){var i=t.datasets[a.datasetIndex].label||"";return i&&(i=a.yLabel+" "+i),i}}},scales:{xAxes:[{type:"time",time:{round:"day",minUnit:"day",tooltipFormat:"dddd, MMM. D"},gridLines:{display:!1},scaleLabel:{display:!1}}],yAxes:[{scaleLabel:{display:!1},ticks:{min:0,suggestedMax:""}}]}}},o={type:"LineWithLine",data:{datasets:[{label:"NA",backgroundColor:"rgba(0,133,186,0.98)",borderColor:"rgba(0,133,186,0.98)",borderWidth:3,pointRadius:3,pointBorderWidth:1,pointBorderColor:"white",pointBackgroundColor:"rgba(0,133,186,0.98)",fill:!1,data:[]}]},options:{legend:{display:!0},tooltips:{mode:"x",intersect:!1,displayColors:!1,titleFontSize:12,callbacks:{label:function(a,t){var i=t.datasets[a.datasetIndex].label||"";return i&&(i=100*a.yLabel+"% "+i),i}}},scales:{xAxes:[{type:"time",time:{round:"day",minUnit:"day",tooltipFormat:"dddd, MMM. D"},gridLines:{display:!1},scaleLabel:{display:!1}}],yAxes:[{scaleLabel:{display:!1},ticks:{min:0,callback:function(a){return Math.round(100*a)+"%"}}}]}}},u={type:"LineWithLine",data:{datasets:[{label:"NA",backgroundColor:"rgba(0,133,186,0.98)",borderColor:"rgba(0,133,186,0.98)",borderWidth:3,pointRadius:3,pointBorderWidth:1,pointBorderColor:"white",pointBackgroundColor:"rgba(0,133,186,0.98)",fill:!1,data:[]}]},options:{legend:{display:!0},tooltips:{mode:"x",intersect:!1,displayColors:!1,titleFontSize:12,callbacks:{label:function(a,t){var i=t.datasets[a.datasetIndex].label||"";return i&&(i=n(a.yLabel)+" "+i),i}}},scales:{xAxes:[{type:"time",time:{round:"day",minUnit:"day",tooltipFormat:"dddd, MMM. D"},gridLines:{display:!1},scaleLabel:{display:!1}}],yAxes:[{scaleLabel:{display:!1},ticks:{min:0,callback:n}}]}}};if(void 0===e[t])return console.log("Missing chart data for "+t),!1;var r=null;if(t.includes("_rate"))r=a.extend(!0,{},o);else if(t.includes("_time"))r=a.extend(!0,{},u);else{r=a.extend(!0,{},d);var s=e[t].data.map((function(a){return a.y})),l=Math.max.apply(null,s),p=l+Math.round(.1*l);l===p&&p++,r.options.scales.yAxes[0].ticks.suggestedMax=p}r.data.datasets[0].label=e[t].label,r.data.datasets[0].data=e[t].data,"pageviews"===t&&void 0!==e.unique_pageviews&&r.data.datasets.push({label:e.unique_pageviews.label,backgroundColor:"purple",borderColor:"purple",borderWidth:3,pointRadius:3,pointBorderWidth:1,pointBorderColor:"white",pointBackgroundColor:"purple",fill:!1,data:e.unique_pageviews.data}),"visits"===t&&r.data.datasets.push({label:e.unique_visits.label,backgroundColor:"purple",borderColor:"purple",borderWidth:3,pointRadius:3,pointBorderWidth:1,pointBorderColor:"white",pointBackgroundColor:"purple",fill:!1,data:e.unique_visits.data});var c=!0;a.each(e[t].data,(function(a,t){null!==t.y&&(c=!1)})),c?i.closest(".wpmudui-analytics-chart").find(".wpmudui-analytics-chart-empty").show():i.closest(".wpmudui-analytics-chart").find(".wpmudui-analytics-chart-empty").hide(),void 0!==window.$type&&window.$type.destroy(),window.$type=new Chart(a(i)[0].getContext("2d"),r)}(a(this).data("type")),t.stopPropagation()})),e=wdp_analytics_ajax.autocomplete,a(".wpmudui-autocomplete").autocomplete({minLength:2,source:e,select:function(i,e){console.log(e.item),a(".wpmudui-autocomplete").val(e.item.label);var n={action:"wdp-analytics"};n.hash=wdp_analytics_ajax.nonce,n.type=e.item.value.type,n.filter=e.item.value.filter,n.range=a("#wpmudui-analytics-range").val(),a(".wpmudui-search-form .wpmudui-icon").remove(),a(".wpmudui-autocomplete").before('<span class="wpmudui-icon wpmudui-icon-loader wpmudui-loading"></span>').css("text-indent","10px"),a.post(window.ajaxurl,n,(function(i){i.success?(wdp_analytics_ajax.current_data=i.data,t(),a(".wpmudui-search-form .wpmudui-icon").fadeOut(400,(function(){a(".wpmudui-autocomplete").css("text-indent","0px")}))):(a(".wpmudui-search-form .wpmudui-icon").remove(),a(".wpmudui-autocomplete").before('<span class="wpmudui-icon dashicons dashicons-warning"></span>').css("text-indent","10px"),a(".wpmudui-search-form .wpmudui-icon").fadeOut(2e3,(function(){a(".wpmudui-autocomplete").css("text-indent","0px")})))}),"json").always((function(){})).fail((function(t){a(".wpmudui-search-form .wpmudui-icon").remove(),a(".wpmudui-autocomplete").before('<span class="wpmudui-icon dashicons dashicons-warning"></span>').css("text-indent","10px"),a(".wpmudui-search-form .wpmudui-icon").fadeOut(2e3,(function(){a(".wpmudui-autocomplete").css("text-indent","0px")}))})),i.preventDefault()}}).autocomplete("widget").addClass("wpmudui-autocomplete-list"),a(".wpmudui-autocomplete").on("input",(function(){""===a(this).val()&&(wdp_analytics_ajax.current_data=wdp_analytics_ajax.overall_data,t())})),i=10,a(".wpmudui-table ~ .wpmudui-pagination-wrapper .wpmudui-page-prev").on("click",(function(t){var i=a(this).closest(".wpmudui-pagination-wrapper"),e=i.prev(".wpmudui-table"),n=+i.data("current-page");if(!e.length)return!0;--n<1&&(n=1),i.data("current-page",n),e.trigger("paginate")})),a(".wpmudui-table ~ .wpmudui-pagination-wrapper .wpmudui-page-next").on("click",(function(t){var e=a(this).closest(".wpmudui-pagination-wrapper"),n=e.prev(".wpmudui-table"),d=n.data("rows"),o=Math.ceil(d/i),u=+e.data("current-page");if(!n.length)return!0;++u>o&&(u=o),e.data("current-page",u),n.trigger("paginate")})),a(".wpmudui-table ~ .wpmudui-pagination-wrapper .wpmudui-goto-page").on("change",(function(t){var e=a(this).closest(".wpmudui-pagination-wrapper"),n=e.prev(".wpmudui-table"),d=n.data("rows"),o=Math.ceil(d/i),u=+a(this).val();if(!n.length)return!0;u<1&&(u=1),u>o&&(u=o),e.data("current-page",u),n.trigger("paginate")})),a(".wpmudui-table").on("reset",(function(t){var i=a(this);i.next(".wpmudui-pagination-wrapper").data("current-page",1),i.trigger("paginate")})),a(".wpmudui-table").on("paginate",(function(t){var e=a(this),n=e.next(".wpmudui-pagination-wrapper"),d=e.data("rows"),o=Math.ceil(d/i);if(!n.length)return!0;if(d<=i)return n.hide(),!0;n.find(".wpmudui-page-next").removeAttr("disabled"),n.find(".wpmudui-page-prev").removeAttr("disabled");var u=+n.data("current-page");u<1&&(u=1),u>o&&(u=o),n.data("current-page",+u),n.data("rows",+d),n.find(".wpmudui-goto-page").attr("min",1),n.find(".wpmudui-goto-page").attr("max",o),n.find(".wpmudui-goto-page").val(u);var r=(u-1)*i+1,s=u*i;n.find(".wpmudui-start-row").html(r),n.find(".wpmudui-end-row").html(s),e.find("tbody tr").hide().slice(r-1,s).show(),1===u&&n.find(".wpmudui-page-prev").attr("disabled","disabled"),u===o&&n.find(".wpmudui-page-next").attr("disabled","disabled")})),a(".wpmudui-table").trigger("paginate"),a(".wpmudui-search-form").find(".wpmudui-handle").on("click",(function(){a(this).closest(".wpmudui-search-form").toggleClass("wpmudui-open")})),t())}))}();
//# sourceMappingURL=dashboard-widget.min.js.map